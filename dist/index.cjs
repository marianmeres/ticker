"use strict";const e=e=>"function"==typeof e,t=(t,n="")=>{if(!e(t))throw new TypeError(`${n} Expecting function arg`.trim())},n=()=>"undefined"!=typeof window?window.performance.now():Date.now();exports.createTicker=(r=1e3,s=!1,o=null)=>{const c=e=>{if(e=parseInt(e,10),Number.isNaN(e)||e<=0)throw new TypeError("Invalid interval. Expecting positive non-zero number of milliseconds.");r=e};c(r);const i=((n,r=null)=>{const s=t=>e(r?.persist)&&r.persist(t);let o=(()=>{const e=new Map,t=t=>(e.has(t)||e.set(t,new Set),e.get(t)),n=(e,n)=>{if("function"!=typeof n)throw new TypeError("Expecting callback function as second argument");return t(e).add(n),()=>t(e).delete(n)};return{publish:(e,n={})=>{t(e).forEach((e=>e(n)))},subscribe:n,subscribeOnce:(e,t)=>{const r=n(e,(e=>{t(e),r()}));return r},unsubscribeAll:t=>e.delete(t)}})(),c=n;s(c);const i=()=>c,u=e=>{c!==e&&(c=e,s(c),o.publish("change",c))};return{set:u,get:i,update:e=>{t(e,"[update]"),u(e(i()))},subscribe:e=>(t(e,"[subscribe]"),e(c),o.subscribe("change",e))}})(0);let u=0,a=0;const l=()=>{const e=n();a||=e,i.set(Date.now());const t=n()-a,s=t?t-r:0,c=Math.max(0,r-s);u=setTimeout(l,c),a=n(),((...e)=>{"function"==typeof o&&o.apply(null,e)})({_start:e,_duration:t,_offset:s,_nextInterval:c})},p={subscribe:i.subscribe,start:()=>(!u&&l(),p),stop:()=>(i.set(0),u&&(clearTimeout(u),u=0),a=0,p),setInterval:e=>(c(e),p)};return s&&p.start(),p};
